<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	<title>card_add</title>
	<link rel="stylesheet" href="/data/assets/bootstrap/css/font-awesome.min.css">
	<link rel="stylesheet" href="/themes/yutui/css/pic.css">	
	<link rel="stylesheet" href="/themes/yutui/css/style.css">	
	<link rel="stylesheet" href="/themes/yutui/statics/css/ectouch.css" />
</head>
<body class="bg-white f-05">
<!--头部-->
<header class="dis-box header-menu Zect-bg color-whie">
  <a class="" href="javascript:history.go(-1)"><i class="iconfont icon-jiantou"></i></a>
  <h3 class="box-flex">編輯個人主頁</h3>
  <div class="header-kong">&nbsp;</div>
</header>
<!--上传图片1-->
<div class="c-card-img-one">
	<div class="l-card-close c-one"><span>X</span></div>
	<div class="c-card-img-oneBg">
		<p><img src="images/new/card_pull.png"></p>
		<p class="col-hui">點擊添加個人形象圖片</p>
	</div>
	<span class="c-card-btn"></span><!--点击上传按钮-->
	<div class="c-card-img-pull" id="headimg" style=""></div>
</div>
<!--图片裁剪-->
<div class="clipbg displaynone">
	<div id="clipArea"></div>
	<div class="loading displaynone">正在载入图片...</div>
	<div class="footer">
		<dl>
			<dd style="background: #fe1041; color: #ffffff;border: none;">打开相册<input type="file" id="file" accept="image/*" ></dd>
			<dd id="clipBtn">完成裁剪</dd>
		</dl>
		<div class="back">取消</div>
	</div>
</div>
<!--上传图片2-->
<div class="c-card-img-two">
	<div class="l-card-close c-two"><span>X</span></div>
	<div class="c-card-img-oneBg">
		<p><img src="images/new/card_pull.png"></p>
		<p class="col-hui">點擊添加個人形象圖片</p>
	</div>
	<span class="c-card-btn-two"></span><!--点击上传按钮-->
	<div class="c-card-img-pull" id="headimg_two" style=""></div>
</div>
<!--图片裁剪-->
<div class="clipbg-two displaynone">
	<div id="clipArea_two"></div>
	<div class="loading displaynone">正在载入图片...</div>
	<div class="footer">
		<dl>
			<dd style="background: #fe1041; color: #ffffff;border: none;">打开相册<input type="file" id="file" accept="image/*" ></dd>
			<dd id="clipBtn_two">完成裁剪</dd>
		</dl>
		<div class="back">取消</div>
	</div>
</div>
<!--上传图片3-->
<div class="c-card-img-three">
	<div class="l-card-close c-three"><span>X</span></div>
	<div class="c-card-img-oneBg">
		<p><img src="images/new/card_pull.png"></p>
		<p class="col-hui">點擊添加個人形象圖片</p>
	</div>
	<span class="c-card-btn-three"></span><!--点击上传按钮-->
	<div class="c-card-img-pull" id="headimg_three" style=""></div>
</div>
<!--图片裁剪-->
<div class="clipbg-three displaynone">
	<div id="clipArea_three"></div>
	<div class="loading displaynone">正在载入图片...</div>
	<div class="footer">
		<dl>
			<dd style="background: #fe1041; color: #ffffff;border: none;">打开相册<input type="file" id="file" accept="image/*" ></dd>
			<dd id="clipBtn_three">完成裁剪</dd>
		</dl>
		<div class="back">取消</div>
	</div>
</div>
<!--展示详情-->
<div class="box">
  <h2 class="f-3 text-center">展示詳情</h2>
  <ul class="s-space" style="padding:1.2rem 3% 0rem 3%;">
    <li class="s-flex c-card-ine w-input"><p>展示方式</p>
    	<select name="" id="cardpic">
    		<option value="1" selected="selected">圖文模式</option>
    		<option value="2">外鏈模式</option>
    		</select><i class="fa fa-angle-down c-cardadd-ico"></i>
    </li>
  </ul>
  <ul class="s-space c-cardadd-no c-cardadd-yes" style="padding:0rem 3%;">
    <li class="s-flex c-card-ine w-input"><p>標題</p><input class="f-02" type="text" name="" placeholder="輸入標題"></li>
    <li class="s-flex c-card-ine w-input"><p>內容</p><textarea cols="" rows="3" placeholder="事業介紹或近期動態等，描述要展示內容"></textarea></li>
    <li class="s-flex c-card-ine w-input"><p>上傳圖片</p><div class="c-card-add layui-btn"  id="test1">+</div></li>
    <li class="s-flex c-card-ine w-input"><div class="c-cardadd-img"  id="demo1"></div></li>
  </ul>
  <ul class="s-space c-cardadd-no" style="padding:0rem 3%;">
    <li class="s-flex c-card-ine w-input"><p>標題</p><input class="f-02" type="text" name="" placeholder="輸入標題"></li>
    <li class="col-hui">跳轉網址 （輸入點擊封面跳轉的網址）</li>
    <li class="w-input"><input class="f-02 c-cardadd-input" type="text" name="" placeholder="http://"></li>
  </ul>
</div>
<!--提交按钮-->
<div class="c-card-editor"><a href="#" class="Cect-bg">完成并保存</a></div>

<script type="text/javascript" src="/themes/yutui/js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="/themes/yutui/photo/js/camera.js/hammer.min.js" ></script>
<script type="text/javascript" src="/themes/yutui/photo/js/camera.js/lrz.all.bundle.js" ></script>
<script type="text/javascript" src="/themes/yutui/photo/js/camera.js/iscroll-zoom-min.js" ></script>
<script type="text/javascript" src="/themes/yutui/photo/js/camera.js/PhotoClip.js" ></script>
<script>
	$(".c-card-btn").click(function(){
		$(".clipbg").fadeIn()
	})
	var clipArea = new  PhotoClip("#clipArea", {
			    size: [500, 260],//裁剪框大小
				outputSize:[0,0],//打开图片大小，[0,0]表示原图大小
				file: "#file",
				view: "#headimg",
				ok: "#clipBtn",
				loadStart: function() { //图片开始加载的回调函数。this 指向当前 PhotoClip 的实例对象，并将正在加载的 file 对象作为参数传入。（如果是使用非 file 的方式加载图片，则该参数为图片的 url）
					$(".loading").removeClass("displaynone");

				},
				loadComplete: function() {//图片加载完成的回调函数。this 指向当前 PhotoClip 的实例对象，并将图片的 <img> 对象作为参数传入。
					$(".loading").addClass("displaynone");

				},
				done: function(dataURL) { //裁剪完成的回调函数。this 指向当前 PhotoClip 的实例对象，会将裁剪出的图像数据DataURL作为参数传入。			
					console.log(dataURL);//dataURL裁剪后图片地址base64格式提交给后台处理
					$(".clipbg").fadeOut()
				}
			});
	$(".back").click(function(){
		$(".clipbg").fadeOut()
	})
	//two
	$(".c-card-btn-two").click(function(){
		$(".clipbg-two").fadeIn()
	})
	var clipArea_two = new  PhotoClip("#clipArea_two", {
			    size: [500, 260],//裁剪框大小
				outputSize:[0,0],//打开图片大小，[0,0]表示原图大小
				file: "#file",
				view: "#headimg_two",
				ok: "#clipBtn_two",
				loadStart: function() { //图片开始加载的回调函数。this 指向当前 PhotoClip 的实例对象，并将正在加载的 file 对象作为参数传入。（如果是使用非 file 的方式加载图片，则该参数为图片的 url）
					$(".loading").removeClass("displaynone");

				},
				loadComplete: function() {//图片加载完成的回调函数。this 指向当前 PhotoClip 的实例对象，并将图片的 <img> 对象作为参数传入。
					$(".loading").addClass("displaynone");

				},
				done: function(dataURL) { //裁剪完成的回调函数。this 指向当前 PhotoClip 的实例对象，会将裁剪出的图像数据DataURL作为参数传入。			
					console.log(dataURL);//dataURL裁剪后图片地址base64格式提交给后台处理
					$(".clipbg-two").fadeOut()
				}
			});
	$(".back").click(function(){
		$(".clipbg-two").fadeOut()
	})
	//three
	$(".c-card-btn-three").click(function(){
		$(".clipbg-three").fadeIn()
	})
	var clipArea_two = new  PhotoClip("#clipArea_three", {
			    size: [500, 260],//裁剪框大小
				outputSize:[0,0],//打开图片大小，[0,0]表示原图大小
				file: "#file",
				view: "#headimg_three",
				ok: "#clipBtn_three",
				loadStart: function() { //图片开始加载的回调函数。this 指向当前 PhotoClip 的实例对象，并将正在加载的 file 对象作为参数传入。（如果是使用非 file 的方式加载图片，则该参数为图片的 url）
					$(".loading").removeClass("displaynone");

				},
				loadComplete: function() {//图片加载完成的回调函数。this 指向当前 PhotoClip 的实例对象，并将图片的 <img> 对象作为参数传入。
					$(".loading").addClass("displaynone");

				},
				done: function(dataURL) { //裁剪完成的回调函数。this 指向当前 PhotoClip 的实例对象，会将裁剪出的图像数据DataURL作为参数传入。			
					console.log(dataURL);//dataURL裁剪后图片地址base64格式提交给后台处理
					$(".clipbg-three").fadeOut()
				}
			});
	$(".back").click(function(){
		$(".clipbg-three").fadeOut()
	})
	//移除背景1
	$(".c-one").click(function(){
		$("#headimg").css("background-image" ,"url()")
	})
	//移除背景2
	$(".c-two").click(function(){
		$("#headimg_two").css("background-image" ,"url()")
	})
	//移除背景3
	$(".c-three").click(function(){
		$("#headimg_three").css("background-image" ,"url()")
	})
	
</script>
<script type="text/javascript" src="/themes/yutui/statics/layui/layui.js"></script>
<script>
    //下拉框判断
    $('#cardpic').change(function () {
    	$('.c-cardadd-no').eq($(this).val()-1).addClass('c-cardadd-yes').siblings().removeClass('c-cardadd-yes')
    })
</script>	
<script>
	layui.use('upload', function () {
		var $ = layui.jquery
		, upload = layui.upload; 
		upload.render({
			elem: '#test1'
			, accept:"file"
			, url: 'url'
			, multiple: true
			//,size: 100 //最大允许上传的文件大小
			, before: function (obj) {
               //预读本地文件示例，不支持ie8
               obj.preview(function (index, file, result) {
               	$('#demo1').append('<div class="c-cardadd-pic"><p><img src="' + result + '"alt="' + file.name + '"></p><p class="c-cardadd-close">删除图片</p></div>');
               	//删除图片
               	$(".c-cardadd-pic").click(function(){
    	            $(this).remove();
                   })
               });
           }
           , Alldone: function (res) {     //done是单个上传完就执行回调  Alldone是全部上传完了才执行回调  后面才发现  入了一个很大的坑
           	if (res) {
 window.parent.location.reload();//刷新父级页面
                       var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引  
                       parent.layer.close(index); //再执行关闭
                   }
               }
           });
	});
    //判断最多只能添加三张图片
    $(".layui-btn").click(function(){
    	var numberimg =($(".c-cardadd-img").find('img').length)
    	if(numberimg > 2){
    		$(".layui-upload-file").attr('type','text'); 
    		alert("親，只能上傳3張圖片哦")
    	}else{
    		$(".layui-upload-file").attr('type','file');
    	}
    });    
</script>
</body>
</html>